"use strict";function set(e,t,i,n){return(set="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,i,n){var s,o=_superPropBase(e,t);if(o){if((s=Object.getOwnPropertyDescriptor(o,t)).set)return s.set.call(n,i),!0;if(!s.writable)return!1}if(s=Object.getOwnPropertyDescriptor(n,t)){if(!s.writable)return!1;s.value=i,Object.defineProperty(n,t,s)}else _defineProperty(n,t,i);return!0})(e,t,i,n)}function _set(e,t,i,n,s){if(!set(e,t,i,n||e)&&s)throw new Error("failed to set property");return i}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _get(e,t,i){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=_superPropBase(e,t);if(n){var s=Object.getOwnPropertyDescriptor(n,t);return s.get?s.get.call(i):s.value}})(e,t,i||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(n){return function(){var e,t=_getPrototypeOf(n);if(_isNativeReflectConstruct()){var i=_getPrototypeOf(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}var SkinManager=function(){function t(e){_classCallCheck(this,t),this.name="SkinManager",this.fields=[],this.options=e,this.newFields=[]}return _createClass(t,[{key:"initFields",value:function(e){var t=0<arguments.length&&void 0!==e?e:jQuery("html");this.clearFields();var i=t.find("[me\\:skin]");this.newFields=[];for(var n=0;n<i.length;n++)this.addField(jQuery(i[n]));for(var s=0;s<this._newFields.length;s++)this.newFields[s].initialize()}},{key:"getField",value:function(e){for(var t in this.fields){var i=this.fields[t];if(i.ID===e.attr("id"))return i}}},{key:"addField",value:function(e,t){var i=1<arguments.length&&void 0!==t&&t,n=e.attr("me:skin"),s={field:e[0],type:n},o="Skin".concat(n.charAt(0).toUpperCase()).concat(n.slice(1));if("function"==typeof Me.skinTypes[o]){if(!e.attr("me:skin:render")){var r=new Me.skinTypes[o](s);this.fields.push(r),this.newFields.push(r),i&&r.initialize()}}else console.error("The skin type ".concat(o," does not exist. Please select one listed in the following array"),Object.keys(Me.skinTypes))}},{key:"clearFields",value:function(){var e=[];for(var t in this.fields){var i=this.fields[t];if("object"==_typeof(i.$el))0<jQuery("html").find(i.$el[0]).length?e.push(i):i.terminate()}this.fields=e}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"options",set:function(e){this._options=e},get:function(){return this._options}},{key:"newFields",get:function(){return this._newFields},set:function(e){this._newFields=e}},{key:"fields",get:function(){return this._fields},set:function(e){this._fields=e}}]),t}();window.Me||(window.Me={}),window.Me.skinType||(Me.skinTypes=[]),Me.skin=new SkinManager,jQuery(document).ready(function(){Me.skin.initFields()});var SkinField=function(){function t(e){_classCallCheck(this,t),this.field=e.field,this.$field=jQuery(e.field),this.ID=this.$field.attr("id"),this.name=this.$field.attr("name"),this.type=this.$field.attr("type")?this.$field.attr("type"):this.$field.prop("tagName").toLowerCase(),this.disabled=!!this.$field.attr("disabled"),this.$label=0<jQuery('label[for="'+this.ID+'"]').length?jQuery('label[for="'+this.ID+'"]'):null,this.$customSkin=0<jQuery('[me\\:skin\\:id="'.concat(this.ID,'"]')).length?jQuery('[me\\:skin\\:id="'.concat(this.ID,'"]')):null,this.dependenciesExist()&&this.requirementsExist()&&(this.options={debug:!(!window.SETTINGS||!SETTINGS.DEBUG_MODE)&&SETTINGS.DEBUG_MODE})}return _createClass(t,[{key:"initialize",value:function(){this.setDOMAttr(),this.setCustomVariables(),this.$customSkin&&(this.removeCommonEvents(),this.addCommonEvents(),this.removeCustomEvents(),this.addCustomEvents(),this.setDefault())}},{key:"addCommonEvents",value:function(){var t=this;this.$customSkin.on("mouseenter.skinMe mouseleave.skinMe",function(e){t.toggleHover(e)}),this.$customSkin.on("keydown.skinMe",function(e){t.keyHandler(e)})}},{key:"removeCommonEvents",value:function(){this.$customSkin.off("mouseenter.skinMe mouseleave.skinMe"),this.$customSkin.off("keydown.skinMe")}},{key:"setDOMAttr",value:function(){this.$field.attr("me:skin:render","true"),this.$field.attr("me:skin:type",this.type),this.$customSkin.attr("me:skin:render","true"),this.$customSkin.attr("me:skin:disabled",this.disabled),this.$customSkin.attr("me:skin:theme",this.$field.attr("me:skin:theme")),this.$field.removeAttr("me:skin:theme"),this.disabled||this.$customSkin.attr("tabindex",0)}},{key:"dependenciesExist",value:function(){var e=!0;return window.$||(console.warn("SkinMe :: Dependencies :: required jquery (http://jquery.com/)"),e=!1),e}},{key:"requirementsExist",value:function(){var e=!0;return this.$customSkin||(console.error("Skin element associated with ID:".concat(this.ID," can't be found. Add me:skin:id=\"").concat(this.ID,'"')),e=!1),this.ID||(console.error("ID attribute must be defined on the native field"),e=!1),e}},{key:"toggleHover",value:function(){this.$field.attr("disabled")||this.$customSkin.toggleClass("hover")}},{key:"setCustomVariables",value:function(){}},{key:"addCustomEvents",value:function(){}},{key:"removeCustomEvents",value:function(){}},{key:"setDefault",value:function(){}},{key:"keyHandler",value:function(){}},{key:"name",get:function(){return this._name},set:function(e){"string"==typeof e?e&&(this._name=e):console.error("The name parameter must be a string")}},{key:"type",get:function(){return this._type},set:function(e){"string"==typeof e?e&&(this._type=e):console.error("The type parameter must be a string")}},{key:"ID",get:function(){return this._ID},set:function(e){"string"==typeof e?e&&(this._ID=e):console.error("The ID parameter must be a string")}},{key:"options",get:function(){return this._options},set:function(e){this._options=e}},{key:"disabled",get:function(){return this._disabled},set:function(e){"boolean"==typeof e?(this.$field.attr("disabled",e),this._disabled=e,this.$customSkin&&(this.$customSkin.attr("me:skin:disabled",e),!0===e?this.$customSkin.attr("tabindex",-1):this.$customSkin.attr("tabindex",0))):console.error("The bool parameter must be a boolean")}}]),t}(),SkinCheckbox=function(){_inherits(n,SkinField);var i=_createSuper(n);function n(e){var t;return _classCallCheck(this,n),(t=i.call(this,e)).classes={checked:"is-checked"},t}return _createClass(n,[{key:"addCustomEvents",value:function(){var t=this;this.$field.on("change.skinMe",function(e){t.changeHandler(e)}),this.$customSkin.on("click.skinMe",function(e){t.clickHandler(e)}),this.$label&&this.$label.on("click.skinMe",function(e){t.clickHandler(e)})}},{key:"removeCustomEvents",value:function(){this.$field.off("change.skinMe"),this.$customSkin.off("click.skinMe"),this.$label&&this.$label.off("click.skinMe")}},{key:"changeHandler",value:function(){this.field.checked?(this.$customSkin.removeClass(this.classes.checked),this.$field.removeClass(this.classes.checked),this.field.checked=!1):(this.$customSkin.addClass(this.classes.checked),this.$field.addClass(this.classes.checked),this.field.checked=!0)}},{key:"clickHandler",value:function(e){this.disabled||(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),this.$field.trigger("change"))}},{key:"keyHandler",value:function(e){_get(_getPrototypeOf(n.prototype),"keyHandler",this).call(this,e),13!==e.keyCode&&32!==e.keyCode||this.$customSkin.trigger("click")}},{key:"disabled",set:function(e){_set(_getPrototypeOf(n.prototype),"disabled",e,this,!0),this.field.checked&&this.changeHandler()}}]),n}();Me.skinTypes.SkinCheckbox=SkinCheckbox;var SkinRadio=function(){_inherits(n,SkinField);var i=_createSuper(n);function n(e){var t;return _classCallCheck(this,n),(t=i.call(this,e)).classes={checked:"is-checked"},t}return _createClass(n,[{key:"addCustomEvents",value:function(){var t=this;this.$field.on("change.skinMe",function(e){t.changeHandler(e)}),this.$customSkin.on("click.skinMe",function(e){t.clickHandler(e)}),this.$label&&this.$label.on("click.skinMe",function(e){t.clickHandler(e)})}},{key:"removeCustomEvents",value:function(){this.$field.off("change.skinMe"),this.$customSkin.off("click.skinMe"),this.$label&&this.$label.off("click.skinMe")}},{key:"changeHandler",value:function(){var n=this;this.field.checked||($.each(jQuery('input[name="'+this.name+'"]'),function(e,t){var i=Me.skin.getField(jQuery(t));i.$customSkin.removeClass(n.classes.checked),i.$field.removeClass(n.classes.checked),i.field.checked=!1}),this.$customSkin.addClass(this.classes.checked),this.$field.addClass(this.classes.checked),this.field.checked=!0)}},{key:"clickHandler",value:function(e){this.disabled||(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),this.$field.trigger("change","label"))}},{key:"keyHandler",value:function(e){_get(_getPrototypeOf(n.prototype),"keyHandler",this).call(this,e),13!==e.keyCode&&32!==e.keyCode||this.$customSkin.trigger("click")}}]),n}();Me.skinTypes.SkinRadio=SkinRadio;var SkinSelect=function(){_inherits(s,SkinField);var i=_createSuper(s);function s(e){var t;return _classCallCheck(this,s),(t=i.call(this,e)).$skinChoicesWrapper=jQuery('[me\\:skin\\:choices="'.concat(t.ID,'"]')),t.$choiceSelected=t.$skinChoicesWrapper.find(".choice[selected]"),t.isAnimating=!1,t.classes={opening:"is-opening",closing:"is-closing",open:"is-open",native:"is-native"},t}return _createClass(s,[{key:"setDefault",value:function(){0<this.$default.length?this.setSelection(this.$default.index()):this.setSelection(0)}},{key:"setDOMAttr",value:function(){_get(_getPrototypeOf(s.prototype),"setDOMAttr",this).call(this),this.$field.parent().attr("me:skin:wrapper",this.ID),this.$field.removeAttr("me:skin:type"),this.$field.parent().attr("me:skin:type",this.type),this.$skinChoicesWrapper.find(".choice").attr("tabindex",-1),this.$field.attr("tabindex",-1)}},{key:"setCustomVariables",value:function(){this.$customSkin&&(this.$default=this.$field.find("option[default]"),this.$selection=jQuery('[me\\:skin\\:selection="'.concat(this.ID,'"]')),this.$wrapper=jQuery('[me\\:skin\\:wrapper="'.concat(this.ID,'"]'))),Me.detect&&Me.detect.isMobile()&&this.$field.addClass(this.classes.native),this.isNative=this.$field.hasClass(this.classes.native)}},{key:"addEventWhenOpen",value:function(){var t=this;jQuery(document).on("click.skinMe",function(e){t.close(e)}),this.$skinChoicesWrapper.find(".choice").on("keydown.skinMe",function(e){13===e.keyCode&&t.handleSelection(e),9===e.keyCode&&t.close()}),this.$skinChoicesWrapper.find(".choice").on("click.skinMe",function(e){t.handleSelection(e)})}},{key:"removeEventOnClose",value:function(){jQuery(document).off("click.skinMe"),this.$skinChoicesWrapper.find(".choice").off("keydown.skinMe"),this.$skinChoicesWrapper.find(".choice").off("click.skinMe")}},{key:"addCustomEvents",value:function(){var t=this;window.addEventListener("resize",function(){t.isOpen&&t.close()}),this.$field.on("change.skinMe",function(e){t.handleChange(e)}),this.isNative||(this.$customSkin.on("click.skinMe",function(e){t.handleState(e)}),this.$label&&this.$label.on("click.skinMe",function(e){t.handleState(e)}))}},{key:"removeCustomEvents",value:function(){var e=this;window.removeEventListener("resize",function(){e.isOpen&&e.close()}),this.$field.off("change.skinMe"),this.isNative||(this.$customSkin.off("click.skinMe"),this.$label&&this.$label.off("click.skinMe"))}},{key:"handleChange",value:function(){this.$choiceSelected=jQuery(this.$skinChoicesWrapper.find(".choice")[this.getSelectedIndex()]),this.$skinChoicesWrapper.find(".choice").attr("selected",!1),jQuery(this.$skinChoicesWrapper.find(".choice")[this.getSelectedIndex()]).attr("selected",!0),this.updateHtml(),this.isOpen&&this.close()}},{key:"handleState",value:function(e){this.disabled||(e.preventDefault(),e.stopPropagation(),this.isOpen?this.close():this.open())}},{key:"open",value:function(){var e=this;this.disabled||this.isAnimating||(this.isAnimating=!0,this.$skinChoicesWrapper.outerHeight(this.choicesHeight),this.$wrapper.addClass(this.classes.opening).on("transitionend",function(){e.$wrapper.addClass(e.classes.open).removeClass(e.classes.opening),e.$wrapper.off("transitionend"),e.isAnimating=!1,jQuery(e.$skinChoicesWrapper.find(".choice")[e.getSelectedIndex()]).focus()}),this.addEventWhenOpen())}},{key:"close",value:function(e){var t=this;this.disabled||this.isAnimating||(e&&e.preventDefault(),this.isOpen&&(this.isAnimating=!0),this.$skinChoicesWrapper.outerHeight(0),this.$wrapper.addClass(this.classes.closing).on("transitionend",function(){t.$wrapper.removeClass("".concat(t.classes.open," ").concat(t.classes.closing)),t.$wrapper.off("transitionend"),t.isAnimating=!1}),this.removeEventOnClose())}},{key:"handleSelection",value:function(e){e.preventDefault(),this.setSelection(jQuery(e.currentTarget).index())}},{key:"setSelection",value:function(e){this.$field.find("option").attr("selected",!1),jQuery(this.$field.find("option")[e])[0].selected="selected",this.$field.trigger("change")}},{key:"getSelectedIndex",value:function(){return this.$field.find('option[value="'+this.$field.val()+'"]').index()}},{key:"updateHtml",value:function(){this.$selection.html(this.$choiceSelected.html())}},{key:"keyHandler",value:function(e){switch(_get(_getPrototypeOf(s.prototype),"keyHandler",this).call(this,e),e.keyCode){case 38:case 40:if(this.isOpen){var t=38===e.keyCode?-1:1,i=this.$customSkin.find(":focus").index(),n=this.$skinChoicesWrapper.find(".choice")[i+t];n&&n.focus()}else this.open();break;case 27:this.$customSkin.focus(),this.close()}}},{key:"requirementsExist",value:function(){var e=_get(_getPrototypeOf(s.prototype),"requirementsExist",this).call(this);return 0<!jQuery('[me\\:skin\\:choices="'.concat(this.ID,'"]')).length&&console.error("Can't find the associated me:skin:choices attribute linked to field. See me:skin:choices in README.md"),0<!jQuery('[me\\:skin\\:selection="'.concat(this.ID,'"]')).length&&console.error("Can't find the associated me:skin:selection attribute linked to field. See me:skin:selection in README.md"),e}},{key:"choicesHeight",get:function(){var i=0;return this.$skinChoicesWrapper.find(".choice").each(function(e,t){i+=jQuery(t).outerHeight(!0)}),i}},{key:"isOpen",get:function(){return this.$wrapper.hasClass(this.classes.open)}}]),s}();Me.skinTypes.SkinSelect=SkinSelect;