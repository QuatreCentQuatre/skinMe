{"version":3,"sources":["me-skin-select.js"],"names":["SkinSelect","options","$skinChoicesWrapper","jQuery","ID","$choiceSelected","find","isAnimating","classes","opening","closing","open","native","$default","length","setSelection","index","$field","parent","attr","removeAttr","type","$customSkin","$selection","$wrapper","Me","detect","isMobile","addClass","isNative","hasClass","document","on","e","close","keyCode","handleSelection","off","window","addEventListener","handleChange","handleState","$label","removeEventListener","getSelectedIndex","updateHtml","isOpen","disabled","preventDefault","stopPropagation","outerHeight","choicesHeight","removeClass","focus","addEventWhenOpen","removeEventOnClose","currentTarget","trigger","val","html","direction","focusChoiceIndex","elToFocus","isValid","console","error","height","each","value","SkinField","skinType","skinTypes"],"mappings":"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","file":"me-skin-select.js","sourcesContent":["class SkinSelect extends SkinField{\n\tconstructor(options){\n\t\tsuper(options);\n\t\tthis.$skinChoicesWrapper = jQuery(`[me\\\\:skin\\\\:choices=\"${this.ID}\"]`);\n\t\tthis.$choiceSelected = this.$skinChoicesWrapper.find('.choice[selected]');\n\t\tthis.isAnimating = false;\n\n\t\tthis.classes = {\n\t\t\topening: 'is-opening',\n\t\t\tclosing: 'is-closing',\n\t\t\topen: 'is-open',\n\t\t\tnative: 'is-native'\n\t\t}\n\t}\n\tsetDefault(){\n\t\tif(this.$default.length > 0){\n\t\t\tthis.setSelection(this.$default.index());\n\t\t} else{\n\t\t\tthis.setSelection(0);\n\t\t}\n\t}\n\tsetDOMAttr(){\n\t\tsuper.setDOMAttr();\n\t\tthis.$field.parent().attr('me:skin:wrapper', this.ID);\n\t\tthis.$field.removeAttr('me:skin:type');\n\t\tthis.$field.parent().attr('me:skin:type', this.type);\n\t\tthis.$skinChoicesWrapper.find('.choice').attr('tabindex', -1);\n\t\tthis.$field.attr('tabindex', -1);\n\t}\n\tsetCustomVariables(){\n\t\tif (this.$customSkin){\n\t\t\tthis.$default = this.$field.find(`option[default]`);\n\t\t\tthis.$selection = jQuery(`[me\\\\:skin\\\\:selection=\"${this.ID}\"]`);\n\t\t\tthis.$wrapper = jQuery(`[me\\\\:skin\\\\:wrapper=\"${this.ID}\"]`);\n\t\t}\n\n\t\tif(Me.detect && Me.detect.isMobile()){\n\t\t\tthis.$field.addClass(this.classes.native);\n\t\t}\n\n\t\tthis.isNative = (this.$field.hasClass(this.classes.native));\n\t}\n\taddEventWhenOpen(){\n\t\tjQuery(document).on('click.skinMe', (e) => {this.close(e)});\n\t\tthis.$skinChoicesWrapper.find('.choice').on('keydown.skinMe', (e)=>{\n\t\t\tif(e.keyCode === 13){this.handleSelection(e)}\n\t\t\tif(e.keyCode === 9){this.close();}\n\t\t});\n\t\tthis.$skinChoicesWrapper.find('.choice').on('click.skinMe', (e) => {this.handleSelection(e)});\n\t}\n\tremoveEventOnClose(){\n\t\tjQuery(document).off('click.skinMe');\n\t\tthis.$skinChoicesWrapper.find('.choice').off('keydown.skinMe');\n\t\tthis.$skinChoicesWrapper.find('.choice').off('click.skinMe');\n\t}\n\taddCustomEvents(){\n\t\twindow.addEventListener('resize', ()=>{this.close();});\n\t\tthis.$field.on('change.skinMe', (e) => {this.handleChange(e)});\n\n\t\tif(!this.isNative){\n\t\t\tthis.$customSkin.on('click.skinMe', (e) => {this.handleState(e)});\n\n\t\t\tif (this.$label) {\n\t\t\t\tthis.$label.on('click.skinMe', (e) => {this.handleState(e)});\n\t\t\t}\n\t\t}\n\t}\n\tremoveCustomEvents(){\n\t\twindow.removeEventListener(\"resize\", ()=>{this.close();});\n\t\tthis.$field.off('change.skinMe');\n\n\t\tif(!this.isNative){\n\t\t\tthis.$customSkin.off('click.skinMe');\n\n\t\t\tif (this.$label) {\n\t\t\t\tthis.$label.off('click.skinMe');\n\t\t\t}\n\t\t}\n\t}\n\thandleChange(e){\n\t\tthis.$choiceSelected = jQuery(this.$skinChoicesWrapper.find('.choice')[this.getSelectedIndex()]);\n\t\tthis.$skinChoicesWrapper.find('.choice').attr('selected', false);\n\t\tjQuery(this.$skinChoicesWrapper.find('.choice')[this.getSelectedIndex()]).attr('selected', true);\n\n\t\tthis.updateHtml();\n\t\tif(this.isOpen){\n\t\t\tthis.close();\n\t\t}\n\t}\n\thandleState(e){\n\t\tif (this.disabled) {return;}\n\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tif(this.isOpen){\n\t\t\tthis.close();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.open();\n\t}\n\topen(){\n\t\tif (this.disabled || this.isAnimating) {return;}\n\n\t\tthis.isAnimating = true;\n\t\tthis.$skinChoicesWrapper.outerHeight(this.choicesHeight);\n\t\tthis.$wrapper.addClass(this.classes.opening).on('transitionend', ()=>{\n\t\t\tthis.$wrapper.addClass(this.classes.open).removeClass(this.classes.opening);\n\t\t\tthis.$wrapper.off('transitionend');\n\t\t\tthis.isAnimating = false;\n\t\t\tjQuery(this.$skinChoicesWrapper.find('.choice')[this.getSelectedIndex()]).focus();\n\t\t});\n\n\t\tthis.addEventWhenOpen();\n\t}\n\tclose(e){\n\t\tif (this.disabled || this.isAnimating) {return;}\n\n\t\tif(e)\n\t\t\te.preventDefault();\n\n\t\tif(this.isOpen){\n\t\t\tthis.isAnimating = true;\n\t\t}\n\n\t\tthis.$skinChoicesWrapper.outerHeight(0);\n\t\tthis.$wrapper.addClass(this.classes.closing).on('transitionend', ()=>{\n\t\t\tthis.$wrapper.removeClass(`${this.classes.open} ${this.classes.closing}`);\n\t\t\tthis.$wrapper.off('transitionend');\n\t\t\tthis.isAnimating = false;\n\t\t});\n\n\t\tthis.removeEventOnClose();\n\t}\n\thandleSelection(e){\n\t\te.preventDefault();\n\t\tthis.setSelection(jQuery(e.currentTarget).index());\n\t}\n\tsetSelection(index){\n\t\tthis.$field.find('option').attr('selected', false);\n\t\tjQuery(this.$field.find('option')[index]).attr('selected', true);\n\t\tthis.$field.trigger('change');\n\t}\n\tgetSelectedIndex(){\n\t\treturn this.$field.find('option[value=\"'+ this.$field.val() +'\"]').index();\n\t}\n\tupdateHtml(){\n\t\tthis.$selection.html(this.$choiceSelected.html());\n\t}\n\n\tkeyHandler(e) {\n\t\tsuper.keyHandler(e);\n\n\t\tswitch (e.keyCode) {\n\t\t\tcase 38:\n\t\t\tcase 40:\n\t\t\t\tif(!this.isOpen){\n\t\t\t\t\tthis.open();\n\t\t\t\t} else{\n\t\t\t\t\tlet direction = (e.keyCode === 38) ? -1 : 1;\n\t\t\t\t\tlet focusChoiceIndex = this.$customSkin.find(':focus').index();\n\t\t\t\t\tlet elToFocus = this.$skinChoicesWrapper.find('.choice')[focusChoiceIndex + direction];\n\n\t\t\t\t\tif(elToFocus){\n\t\t\t\t\t\telToFocus.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 27:\n\t\t\t\tthis.$customSkin.focus();\n\t\t\t\tthis.close();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\trequirementsExist(){\n\t\tlet isValid = super.requirementsExist();\n\n\t\tif(!jQuery(`[me\\\\:skin\\\\:choices=\"${this.ID}\"]`).length > 0){\n\t\t\tconsole.error(`Can't find the associated me:skin:choices attribute linked to field. See me:skin:choices in README.md`)\n\t\t}\n\n\t\tif(!jQuery(`[me\\\\:skin\\\\:selection=\"${this.ID}\"]`).length > 0){\n\t\t\tconsole.error(`Can't find the associated me:skin:selection attribute linked to field. See me:skin:selection in README.md`)\n\t\t}\n\n\t\treturn isValid;\n\t}\n\n\tget choicesHeight(){\n\t\tlet height = 0;\n\n\t\tthis.$skinChoicesWrapper.find('.choice').each((index, value) => {\n\t\t\theight += jQuery(value).outerHeight(true);\n\t\t});\n\n\t\treturn height;\n\t}\n\n\tget isOpen(){\n\t\treturn this.$wrapper.hasClass(this.classes.open);\n\t}\n}\n\nif (!window.Me.skinType){\n    Me.skinTypes = [];\n}\n\n\nMe.skinTypes['SkinSelect'] = SkinSelect;"],"sourceRoot":"../src"}